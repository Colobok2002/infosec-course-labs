# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4

**¬´–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö¬ª**

---

### –ó–∞–¥–∞–Ω–∏–µ 1

–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ  –º–µ—Ç–æ–¥–æ–º–ø—Ä–æ—Å—Ç–æ–π –∑–∞–º–µ–Ω—ã –Ω–∞ –∫–ª—é—á–µ –ö (–∫–ª—é—á–æ–º –ö —è–≤–ª—è–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ ‚Ññ1 —Å–º. –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å
–Ω–æ–º–µ—Ä–æ–º —Å–≤–æ–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞).

> –ü—Ä–∏–º–µ—Ä –∫–ª—é—á–∞ (—Ç–∞–±–ª–∏—Ü–∞ –∑–∞–º–µ–Ω—ã):
> –û—Ç–∫—Ä—ã—Ç—ã–µ –±—É–∫–≤—ã:    –∞ –± –≤ –≥ –¥ –µ –∂ –∑ –∏ –∫ –ª –º –Ω –æ –ø —Ä —Å —Ç —É —Ñ —Ö —Ü —á —à —â —ä —ã —å —ç —é —è
> –®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ:       –≥ –ª —å –ø –¥ —Ä –∞ –º —Ü –≤ —ç —ä —Ö –æ –± –Ω —Å –∂ —è –∏ —é –∫ —â —Ñ –µ —É —ã —á —à —Ç –∑

---

#### –†–µ—à–µ–Ω–∏–µ:

> –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç: **"—Ü–≤—ç—ä—Ö–æ"**

**–†–µ—à–µ–Ω–∏–µ:**

- —Ü ‚Üí –∫
- –≤ ‚Üí –∫
- —ç ‚Üí –ª
- —ä ‚Üí –º
- —Ö ‚Üí –Ω
- –æ ‚Üí –æ

**–û—Ç–≤–µ—Ç:** `"–∫–∫–ª–º–Ω–æ"`

---

### –ó–∞–¥–∞–Ω–∏–µ 2

–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –≥–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∫–ª—é—á–µ –ö —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ –º–æ–¥—É–ª—é 32 (–∫–ª—é—á –ö —Å–º. –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–º–µ—Ä–æ–º —Å–≤–æ–µ–≥–æ
–≤–∞—Ä–∏–∞–Ω—Ç–∞).

#### üìå –§–æ—Ä–º—É–ª–∞:

$$
s_i = (C(t_i) + k_i) \mod 32
$$

---

#### –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:

- `t_i` ‚Äî i-–π —Å–∏–º–≤–æ–ª –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- `C(t_i)` ‚Äî –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —Å–∏–º–≤–æ–ª–∞ `t_i` –≤ –∞–ª—Ñ–∞–≤–∏—Ç–µ (0-31)
- `k_i` ‚Äî i-–π —ç–ª–µ–º–µ–Ω—Ç –∫–ª—é—á–∞
- `s_i` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–Ω–æ–º–µ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞)
- `mod 32` ‚Äî –æ–ø–µ—Ä–∞—Ü–∏—è –≤–∑—è—Ç–∏—è –æ—Å—Ç–∞—Ç–∫–∞ –ø–æ –º–æ–¥—É–ª—é 32
- `n` ‚Äî –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

---

#### –†–µ—à–µ–Ω–∏–µ:

> –°–æ–æ–±—â–µ–Ω–∏–µ: **–ù–ê–°–¢–£–ü–ê–¢–¨**
> –ö–ª—é—á: `05 12 03 29 24 12 30 14 11 31`
> –ê–ª—Ñ–∞–≤–∏—Ç: 32 –±—É–∫–≤—ã —Ä—É—Å—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞, –µ –∏ —ë —Å—á–∏—Ç–∞—é—Ç—Å—è –æ–¥–Ω–æ–π –±—É–∫–≤–æ–π

–°–æ–æ–±—â–µ–Ω–∏–µ ‚Üí –ù –ê –° –¢ –£ –ü –ê –¢ –¨

–ù–æ–º–µ—Ä–∞ : [13, 0, 17, 18, 19, 15, 0, 18, 32]

- 13+5 = 18
- 0+12 = 12
- 17+3 = 20
- 18+29 = 47 ‚Üí 47 % 32 = 15
- 19+24 = 43 % 32 = 11
- 15+12 = 27
- 0+30 = 30
- 18+14 = 32
- 28+11 = 39 % 32 = 7
- 32+31 = 63 % 32 = 31

**–û—Ç–≤–µ—Ç:** `18 12 20 15 11 27 30 32 07 31`

---

### –ó–∞–¥–∞–Ω–∏–µ 3

–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ñ—Ä–∞–∑—É, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é –ø—Ä–∏ –ø–æ–º–æ—â–∏ —à–∏—Ñ—Ä–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ 7x8, –Ω–∞ –∫–ª—é—á–µ –ö (–∫–ª—é—á –ö –∏ —Ñ—Ä–∞–∑—É —Å–º. –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è,
–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–º–µ—Ä–æ–º —Å–≤–æ–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞).

#### –†–µ—à–µ–Ω–∏–µ:

```
def vertical_encrypt(text: str, rows: int, cols: int, key: list[int]) -> str:
    """
    –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏.

    :param text: –û—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç –¥–ª–∏–Ω–æ–π rows * cols
    :param rows: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ
    :param cols: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ
    :param key: –°–ø–∏—Å–æ–∫ –¥–ª–∏–Ω–æ–π cols ‚Äî –∫–ª—é—á –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ (–Ω–æ–º–µ—Ä–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –æ—Ç 1 –¥–æ cols)
    :return: –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
    """
    matrix = [list(text[i * cols:(i + 1) * cols]) for i in range(rows)]
    transposed = list(zip(*matrix))
    reordered = [transposed[k - 1] for k in key]
    return ''.join(''.join(col) for col in reordered)


def vertical_decrypt(text: str, rows: int, cols: int, key: list[int]) -> str:
    """
    –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–æ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏.

    :param text: –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª–∏–Ω–æ–π rows * cols
    :param rows: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ
    :param cols: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ
    :param key: –ö–ª—é—á –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏, –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–π –ø—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏
    :return: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    """
    if len(text) != rows * cols:
        raise ValueError("–î–ª–∏–Ω–∞ —à–∏—Ñ—Ä—Ç–µ–∫—Å—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–∞–≤–Ω–∞ rows * cols.")

    column_chunks = [list(text[i * rows:(i + 1) * rows]) for i in range(cols)]
    ordered_columns: list[list[str]] = [[""]] * cols
    for i, k in enumerate(key):
        ordered_columns[k - 1] = column_chunks[i]

    return ''.join(ordered_columns[c][r] for r in range(rows) for c in range(cols))


# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
rows = 7
cols = 8
key = [5, 1, 4, 2, 6, 3, 8, 7]
original_text = "–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è—à–∏—Ñ—Ä–æ–≤–∫–∞–∏—Å–ø–æ–ª—å–∑—É–µ—Ç–∫–ª—é—á–¥–ª—è–ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫–≤—Ç–µ–∫—Å—Ç–µ"

encrypted = vertical_encrypt(original_text, rows, cols, key)
decrypted = vertical_decrypt(encrypted, rows, cols, key)

print(encrypted) -> –∏—à–∏–µ—è–Ω–∫–≤—å–æ–ª—é–µ–∫—Ç—è–∞—É–ª–∞–µ–µ–Ω–≤—å—á—Å–≤–∫–∏—Å—Ç–ø–æ—Å—Ä–∞–∫–∑–¥—Ç—Ç–ª—Ä–æ–ª—Ä–æ–µ–∞—Ñ–ø–∫–µ–≤—Ç
print(decrypted) -> –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è—à–∏—Ñ—Ä–æ–≤–∫–∞–∏—Å–ø–æ–ª—å–∑—É–µ—Ç–∫–ª—é—á–¥–ª—è–ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫–≤—Ç–µ–∫—Å—Ç–µ


```

### ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 4: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –º–µ—Ç–æ–¥–æ–º –ü–ª–µ–π—Ñ–µ—Ä–∞


–î–µ—à–∏—Ñ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –≤ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–∏, —á—Ç–æ –æ–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ç–æ–¥–∞ –ü–ª–µ–π—Ñ–µ—Ä–∞ –≤ 30-—Ç–∏ –±—É–∫–≤–µ–Ω–Ω–æ–º —Ä—É—Å—Å–∫–æ–º –∞–ª—Ñ–∞–≤–∏—Ç–µ, –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º —è–≤–ª—è–µ—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç –∞–ª—Ñ–∞–≤–∏—Ç–∞ (–±–∏–≥—Ä–∞–º–º—É —Å–º. –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–º–µ—Ä–æ–º —Å–≤–æ–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞).

#### –†–µ—à–µ–Ω–∏–µ:

```
russian_alphabet = "–∞–±–≤–≥–¥–µ–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—ã—é—è"

def generate_playfair_table(keyword: str) -> list[list[str]]:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É –ü–ª–µ–π—Ñ–µ—Ä–∞ 5x6 –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É.

    :param keyword: –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ
    :return: –¢–∞–±–ª–∏—Ü–∞ 5x6 –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ —Å–ø–∏—Å–∫–æ–≤
    """
    filtered_key = ''
    seen = set()
    for c in keyword:
        if c in russian_alphabet and c not in seen:
            seen.add(c)
            filtered_key += c
    remaining = ''.join(c for c in russian_alphabet if c not in filtered_key)
    sequence = filtered_key + remaining
    return [list(sequence[i * 6:(i + 1) * 6]) for i in range(5)]

def find_position(table: list[list[str]], char: str) -> tuple[int, int]:
    """
    –ù–∞—Ö–æ–¥–∏—Ç –ø–æ–∑–∏—Ü–∏—é —Å–∏–º–≤–æ–ª–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ.

    :param table: –¢–∞–±–ª–∏—Ü–∞ –ü–ª–µ–π—Ñ–µ—Ä–∞
    :param char: –°–∏–º–≤–æ–ª –¥–ª—è –ø–æ–∏—Å–∫–∞
    :return: –ö–æ—Ä—Ç–µ–∂ (—Å—Ç—Ä–æ–∫–∞, —Å—Ç–æ–ª–±–µ—Ü)
    """
    for i, row in enumerate(table):
        if char in row:
            return i, row.index(char)
    raise ValueError(f"–°–∏–º–≤–æ–ª {char} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ.")

def playfair_encrypt(text: str, table: list[list[str]]) -> str:
    """
    –®–∏—Ñ—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –º–µ—Ç–æ–¥–æ–º –ü–ª–µ–π—Ñ–µ—Ä–∞.

    :param text: –û—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç
    :param table: –¢–∞–±–ª–∏—Ü–∞ –ü–ª–µ–π—Ñ–µ—Ä–∞
    :return: –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    """
    bigrams = []
    i = 0
    while i < len(text):
        a = text[i]
        b = text[i + 1] if i + 1 < len(text) else '—Ñ'
        if a == b:
            b = '—Ñ'
            i += 1
        else:
            i += 2
        bigrams.append((a, b))

    result = ""
    for a, b in bigrams:
        ra, ca = find_position(table, a)
        rb, cb = find_position(table, b)

        if ra == rb:
            result += table[ra][(ca + 1) % 6]
            result += table[rb][(cb + 1) % 6]
        elif ca == cb:
            result += table[(ra + 1) % 5][ca]
            result += table[(rb + 1) % 5][cb]
        else:
            result += table[ra][cb]
            result += table[rb][ca]

    return result

def playfair_decrypt(cipher: str, table: list[list[str]]) -> str:
    """
    –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥–æ–º –ü–ª–µ–π—Ñ–µ—Ä–∞.

    :param cipher: –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    :param table: –¢–∞–±–ª–∏—Ü–∞ –ü–ª–µ–π—Ñ–µ—Ä–∞
    :return: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    """
    bigrams = [(cipher[i], cipher[i + 1]) for i in range(0, len(cipher), 2)]

    result = ""
    for a, b in bigrams:
        ra, ca = find_position(table, a)
        rb, cb = find_position(table, b)

        if ra == rb:
            result += table[ra][(ca - 1) % 6]
            result += table[rb][(cb - 1) % 6]
        elif ca == cb:
            result += table[(ra - 1) % 5][ca]
            result += table[(rb - 1) % 5][cb]
        else:
            result += table[ra][cb]
            result += table[rb][ca]

    return result

# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
keyword = "–∫–ª—é—á"
text = "—Ç–µ–∫—Å—Ç –¥–ª—è —Ç–µ—Å—Ç–∞"
text = ''.join(c for c in text if c in russian_alphabet)

table = generate_playfair_table(keyword)
encrypted = playfair_encrypt(text, table)
decrypted = playfair_decrypt(encrypted, table)

print("–¢–∞–±–ª–∏—Ü–∞ –ü–ª–µ–π—Ñ–µ—Ä–∞:")
for row in table:
    print(" ".join(row))

print("\n–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:", encrypted) # -> —É–¥–ª—Ä—â–º–∞—à—É–¥—Ç—É–∂—è
print("–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:", decrypted) # -> —Ç–µ–∫—Å—Ç–¥–ª—è—Ç–µ—Å—Ç–∞—Ñ

```
